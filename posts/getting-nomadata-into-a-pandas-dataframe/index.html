<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Getting NOMAData into a Pandas DataFrame | Erdem K's DS corner</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://madhatter106.github.io/DataScienceCorner/posts/getting-nomadata-into-a-pandas-dataframe/">
<!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]--><meta name="author" content="Erdem Karakoylu">
<meta property="og:site_name" content="Erdem K's DS corner">
<meta property="og:title" content="Getting NOMAData into a Pandas DataFrame">
<meta property="og:url" content="https://madhatter106.github.io/DataScienceCorner/posts/getting-nomadata-into-a-pandas-dataframe/">
<meta property="og:description" content="In this post, I'm going to briefly describe how a I download the NASA bio-Optical Marine Algorithm Dataset or NOMAD created for algorithm development, extract the data I need and store it all neatly i">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2017-03-15T14:10:25-04:00">
<meta property="article:tag" content="chlorophyll">
<meta property="article:tag" content="ocean color">
<meta property="article:tag" content="pandas">
</head>
<body>
    <section class="social"><ul>
<li><a href="../../index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="../../archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="../../categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="../../rss.xml" title="RSS"><i class="icon-rss"></i></a></li>
            <li><a href="https://www.linkedin.com/in/erdem-karak%C3%B6yl%C3%BC-49487455" title="About me"><i class="icon-user"></i></a></li>
            <li><a href="https://twitter.com/grayWolfDC" title="My Twitter"><i class="icon-twitter"></i></a></li>
            <li><a href="https://github.com/madHatter106" title="My Github"><i class="icon-github"></i></a></li>

        </ul></section><section class="page-content"><div class="content" rel="main">
    <div class="post">
        <h1 class="p-name entry-title" itemprop="headline name">Getting NOMAData into a Pandas DataFrame</h1>

        <div class="meta">
            <div class="authordate">
                <time class="timeago" datetime="2017-03-15T14:10:25-04:00">2017-03-15 14:10</time>
            
                      |  
        <a href="index.ipynb" id="sourcelink">Source</a>

            </div>
                    <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="../../categories/chlorophyll/" rel="tag">chlorophyll</a></li>
           <li><a class="tag p-category" href="../../categories/ocean-color/" rel="tag">ocean color</a></li>
           <li><a class="tag p-category" href="../../categories/pandas/" rel="tag">pandas</a></li>
        </ul>
</div>

        </div>
        <div class="body">
            <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this post, I'm going to briefly describe how a I download the <a href="https://seabass.gsfc.nasa.gov/wiki/NOMAD">NASA bio-Optical Marine Algorithm Dataset or NOMAD</a> created for algorithm development, extract the data I need and store it all neatly in a Pandas DataFrame. Here I use the latest dataset, NOMAD v.2, created in 2008.
<!-- Teaser_End -->
First things first; imports!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pickle</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The data can be accessed through a URL that I'll store in a string below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">NOMADV2url</span><span class="o">=</span><span class="s1">'https://seabass.gsfc.nasa.gov/wiki/NOMAD/nomad_seabass_v2.a_2008200.txt'</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, I'll write a couple of functions. The first to get the data from the url. The second function will parse the text returned by the first function and put in a Pandas DataFrame. This second function makes more sense after inspecting the content of the page at the url above.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">GetNomad</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">NOMADV2url</span><span class="p">):</span>
    <span class="sd">"""Download and return data as text"""</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">NOMADV2url</span><span class="p">)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>    
    <span class="n">resp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">content</span>

<span class="k">def</span> <span class="nf">ParseTextFile</span><span class="p">(</span><span class="n">textFile</span><span class="p">,</span> <span class="n">topickle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">convert2DateTime</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    * topickle: pickle resulting DataFrame if True</span>
<span class="sd">    * convert2DateTime: join date/time columns and convert entries to datetime objects</span>
<span class="sd">    * kwargs:</span>
<span class="sd">        pkl_fname: pickle file name to save DataFrame by, if topickle=True</span>
<span class="sd">    """</span>
    <span class="c1"># Pre-compute some regex</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'^/fields=(.+)'</span><span class="p">)</span> <span class="c1"># to get field/column names</span>
    <span class="n">units</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'^/units=(.+)'</span><span class="p">)</span> <span class="c1"># to get units -- optional</span>
    <span class="n">endHeader</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'^/end_header'</span><span class="p">)</span> <span class="c1"># to know when to start storing data</span>
    <span class="c1"># Set some milestones</span>
    <span class="n">noFields</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">getData</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># loop through the text data</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">textFile</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">noFields</span><span class="p">:</span>
            <span class="n">fieldStr</span> <span class="o">=</span> <span class="n">columns</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fieldStr</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">noFields</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">fieldList</span> <span class="o">=</span> <span class="n">fieldStr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span>
                <span class="n">dataDict</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">fieldList</span><span class="p">)</span>
                <span class="k">continue</span> <span class="c1"># nothing left to do with this line, keep looping</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">getData</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">endHeader</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
                <span class="c1"># end of header reached, start acquiring data</span>
                <span class="n">getData</span> <span class="o">=</span> <span class="kc">True</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dataList</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">field</span><span class="p">,</span><span class="n">datum</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fieldList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">dataDict</span><span class="p">[</span><span class="n">field</span><span class="p">]:</span>
                    <span class="n">dataDict</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">dataDict</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datum</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataDict</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">fieldList</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">convert2DateTime</span><span class="p">:</span>
        <span class="n">datetimelabels</span><span class="o">=</span><span class="p">[</span><span class="s1">'year'</span><span class="p">,</span> <span class="s1">'month'</span><span class="p">,</span> <span class="s1">'day'</span><span class="p">,</span> <span class="s1">'hour'</span><span class="p">,</span> <span class="s1">'minute'</span><span class="p">,</span> <span class="s1">'second'</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">'Datetime'</span><span class="p">]</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">datetimelabels</span><span class="p">],</span>
                                       <span class="nb">format</span><span class="o">=</span><span class="s1">'%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%S'</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">datetimelabels</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">topickle</span><span class="p">:</span>
        <span class="n">fname</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">'pkl_fname'</span><span class="p">,</span> <span class="s1">'dfNomad2.pkl'</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">ParseTextFile</span><span class="p">(</span><span class="n">GetNomad</span><span class="p">(),</span> <span class="n">topickle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">convert2DateTime</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">pkl_fname</span><span class="o">=</span><span class="s1">'/accounts/ekarakoy/DATA/dfNomadRaw.pkl'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[5]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>lat</th>
      <th>lon</th>
      <th>id</th>
      <th>oisst</th>
      <th>etopo2</th>
      <th>chl</th>
      <th>chl_a</th>
      <th>kd405</th>
      <th>kd411</th>
      <th>kd443</th>
      <th>...</th>
      <th>diato</th>
      <th>lut</th>
      <th>zea</th>
      <th>chl_b</th>
      <th>beta-car</th>
      <th>alpha-car</th>
      <th>alpha-beta-car</th>
      <th>flag</th>
      <th>cruise</th>
      <th>Datetime</th>
    </tr></thead>
<tbody>
<tr>
<th>0</th>
      <td>38.4279</td>
      <td>-76.61</td>
      <td>1565</td>
      <td>3.7</td>
      <td>0.0</td>
      <td>38.19</td>
      <td>-999</td>
      <td>-999</td>
      <td>3.9455</td>
      <td>3.1457</td>
      <td>...</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>20691</td>
      <td>ace0301</td>
      <td>2003-04-15 15:15:00</td>
    </tr>
<tr>
<th>1</th>
      <td>38.368</td>
      <td>-76.5</td>
      <td>1566</td>
      <td>3.7</td>
      <td>0.0</td>
      <td>35.01</td>
      <td>-999</td>
      <td>-999</td>
      <td>2.5637</td>
      <td>2.0529</td>
      <td>...</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>20675</td>
      <td>ace0301</td>
      <td>2003-04-15 16:50:00</td>
    </tr>
<tr>
<th>2</th>
      <td>38.3074</td>
      <td>-76.44</td>
      <td>1567</td>
      <td>3.7</td>
      <td>1</td>
      <td>26.91</td>
      <td>-999</td>
      <td>-999</td>
      <td>2.1533</td>
      <td>1.7531</td>
      <td>...</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>20691</td>
      <td>ace0301</td>
      <td>2003-04-15 17:50:00</td>
    </tr>
<tr>
<th>3</th>
      <td>38.6367</td>
      <td>-76.32</td>
      <td>1568</td>
      <td>3.7</td>
      <td>3</td>
      <td>47.96</td>
      <td>-999</td>
      <td>-999</td>
      <td>2.69</td>
      <td>2.2985</td>
      <td>...</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>20675</td>
      <td>ace0301</td>
      <td>2003-04-17 18:15:00</td>
    </tr>
<tr>
<th>4</th>
      <td>38.3047</td>
      <td>-76.44</td>
      <td>1559</td>
      <td>22.03</td>
      <td>1</td>
      <td>23.55</td>
      <td>-999</td>
      <td>-999</td>
      <td>3.095</td>
      <td>2.3966</td>
      <td>...</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>20691</td>
      <td>ace0302</td>
      <td>2003-07-21 18:27:00</td>
    </tr>
</tbody>
</table>
<p>5 rows × 212 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This DataFrame quite large and unwieldy with 212 columns. But Pandas makes it easy to extract the necessary data for a particular project. For my current project, which I'll go over in a subsequent post, I need field data relevant to the <a href="https://en.wikipedia.org/wiki/SeaWiFS">SeaWiFS sensor</a>, in particular optical data at wavelengths 412, 443, 490, 510, 555, and 670 nm. First let's look at the available bands as they appear in spectral surface irradiance column labels, which start with 'es'.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bandregex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">'es([0-9]+)'</span><span class="p">)</span>
<span class="n">bands</span> <span class="o">=</span> <span class="n">bandregex</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>['405', '411', '443', '455', '465', '489', '510', '520', '530', '550', '555', '560', '565', '570', '590', '619', '625', '665', '670', '683']
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now I can extract data with bands that are the closest to what I need. In the process I'm going to use water leaving radiance and spectral surface irradiance to compute remote sensing reflectance, rrs. I will store this new data in a new DataFrame, dfSwf.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">swfBands</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'411'</span><span class="p">,</span><span class="s1">'443'</span><span class="p">,</span><span class="s1">'489'</span><span class="p">,</span><span class="s1">'510'</span><span class="p">,</span><span class="s1">'555'</span><span class="p">,</span><span class="s1">'670'</span><span class="p">]</span>
<span class="n">dfSwf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'rrs</span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">swfBands</span><span class="p">])</span>
<span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">swfBands</span><span class="p">:</span>
    <span class="n">dfSwf</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">'rrs</span><span class="si">%s</span><span class="s1">'</span><span class="o">%</span><span class="k">b</span>] = df.loc[:,'lw%s' % b].astype('f8') / df.loc[:,'es%s' % b].astype('f8')
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfSwf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[8]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>rrs411</th>
      <th>rrs443</th>
      <th>rrs489</th>
      <th>rrs510</th>
      <th>rrs555</th>
      <th>rrs670</th>
    </tr></thead>
<tbody>
<tr>
<th>0</th>
      <td>0.001204</td>
      <td>0.001686</td>
      <td>0.003293</td>
      <td>0.004036</td>
      <td>0.007479</td>
      <td>0.003465</td>
    </tr>
<tr>
<th>1</th>
      <td>0.001062</td>
      <td>0.001384</td>
      <td>0.002173</td>
      <td>0.002499</td>
      <td>0.004152</td>
      <td>0.001695</td>
    </tr>
<tr>
<th>2</th>
      <td>0.000971</td>
      <td>0.001185</td>
      <td>0.001843</td>
      <td>0.002288</td>
      <td>0.004246</td>
      <td>0.001612</td>
    </tr>
<tr>
<th>3</th>
      <td>0.001472</td>
      <td>0.001741</td>
      <td>0.002877</td>
      <td>0.003664</td>
      <td>0.006982</td>
      <td>0.003234</td>
    </tr>
<tr>
<th>4</th>
      <td>0.000905</td>
      <td>0.001022</td>
      <td>0.001506</td>
      <td>0.001903</td>
      <td>0.002801</td>
      <td>0.001791</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>My project is about developing a bayesian framework for estimating biological variables using remote sensing data. So I'll need to copy over a few more features from the inital dataset.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfSwf</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'i4'</span><span class="p">)</span> <span class="c1"># in case I need to relate this data to the original</span>
<span class="n">dfSwf</span><span class="p">[</span><span class="s1">'datetime'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Datetime</span>
<span class="n">dfSwf</span><span class="p">[</span><span class="s1">'hplc_chl'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">chl_a</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'f8'</span><span class="p">)</span>
<span class="n">dfSwf</span><span class="p">[</span><span class="s1">'fluo_chl'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">chl</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'f8'</span><span class="p">)</span>
<span class="n">dfSwf</span><span class="p">[</span><span class="s1">'lat'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'f8'</span><span class="p">)</span>
<span class="n">dfSwf</span><span class="p">[</span><span class="s1">'lon'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'f8'</span><span class="p">)</span>
<span class="n">dfSwf</span><span class="p">[</span><span class="s1">'depth'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">etopo2</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'f8'</span><span class="p">)</span>
<span class="n">dfSwf</span><span class="p">[</span><span class="s1">'sst'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">oisst</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'f8'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="n">swfBands</span><span class="p">:</span>
    <span class="n">addprods</span><span class="o">=</span><span class="p">[</span><span class="s1">'a'</span><span class="p">,</span><span class="s1">'ad'</span><span class="p">,</span><span class="s1">'ag'</span><span class="p">,</span><span class="s1">'ap'</span><span class="p">,</span><span class="s1">'bb'</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">prod</span> <span class="ow">in</span> <span class="n">addprods</span><span class="p">:</span>
        <span class="n">dfSwf</span><span class="p">[</span><span class="s1">'</span><span class="si">%s%s</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">prod</span><span class="p">,</span><span class="n">band</span><span class="p">)]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'</span><span class="si">%s%s</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">prod</span><span class="p">,</span> <span class="n">band</span><span class="p">)]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'f8'</span><span class="p">)</span>
<span class="n">dfSwf</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">-</span><span class="mi">999</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Tallying the features I've gathered...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dfSwf</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Index(['rrs411', 'rrs443', 'rrs489', 'rrs510', 'rrs555', 'rrs670', 'id',
       'datetime', 'hplc_chl', 'fluo_chl', 'lat', 'lon', 'depth', 'sst',
       'a411', 'ad411', 'ag411', 'ap411', 'bb411', 'a443', 'ad443', 'ag443',
       'ap443', 'bb443', 'a489', 'ad489', 'ag489', 'ap489', 'bb489', 'a510',
       'ad510', 'ag510', 'ap510', 'bb510', 'a555', 'ad555', 'ag555', 'ap555',
       'bb555', 'a670', 'ad670', 'ag670', 'ap670', 'bb670'],
      dtype='object')
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That seems like a good dataset to start with. I'll pickle this DataFrame for later.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfSwf</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s1">'/accounts/ekarakoy/DATA/dfNomadSWF.pkl'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That's it. Until next time, <em>Happy Hacking!</em></p>

</div>
</div>
</div>
    </div>
  </div>

        </div>
                <ul class="pager hidden-print">
<li class="previous">
                <a href="../xarray-geoviews-a-new-perspective-on-oceanographic-data-part-ii/" rel="prev" title="XARRAY &amp; GEOVIEWS A new perspective on oceanographic data - part II">Previous post</a>
            </li>
        </ul>
<script src="https://apis.google.com/js/plusone.js"></script><div class="g-comments" data-href="https://madhatter106.github.io/DataScienceCorner/posts/getting-nomadata-into-a-pandas-dataframe/" data-first_party_property="BLOGGER" data-view_type="FILTERED_POSTMOD">
</div>


    </div>
                     <footer id="footer"><p>Contents © 2017         <a href="mailto:erdemk@protonmail.com">Erdem Karakoylu</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </section><script src="../../assets/js/all-nocdn.js" type="text/javascript"></script><!-- Social buttons --><div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more"><i class="icon-share-sign icon-2x"></i>    Share</a>
<ul>
<li>
<a class="addthis_button_twitter"><i class="icon-twitter icon-2x"></i>    Twitter</a>
</li>
<li>
<a class="addthis_button_google_plusone_share"><i class="icon-google-plus-sign icon-2x"></i>    Google+</a>
</li>
<li>
<a class="addthis_button_linkedin"><i class="icon-linkedin icon-2x"></i>    Linkedin</a>
</li>
<li>
<a class="addthis_button_facebook"><i class="icon-facebook-sign icon-2x"></i>    Facebook</a>
</li>
</ul>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script><!-- End of social buttons --><script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
